"------------------------------------------------------------------------------
" vimperator settings
"------------------------------------------------------------------------------
colorscheme vimpwhite

set complete=tl
set focuscontent
set hintchars=hjklasdfgyuiopqwertnmzxcvb
set messagetimeout=2000

"------------------------------------------------------------------------------
" plugin settings
"------------------------------------------------------------------------------
" plugin_loader.js
let g:plugin_loader_roots = "~/.vimperator/vimperator-plugins.git/"
"let g:plugin_loader_plugins = "_libly,browser_object,feedSomeKeys_3,ime_controller,walk-input,ldrize_cooperation"
let g:plugin_loader_plugins = "_libly,browser_object,feedSomeKeys_3,ime_controller,walk-input"

" browser_object.js
let g:browser_object_prefix = ','

" ime_controller.js
let g:ex_ime_mode = "inactive"
let g:textarea_ime_mode = "inactive"

" copy.js (一部改変しているのでpluginフォルダより読み込み)
javascript <<EOM
liberator.globalVariables.copy_templates = [
   { label: 'titleAndURL',    value: '%TITLE%\n%URL%' },
   { label: 'URL',            value: '%URL%' },
   { label: 'title',          value: '%TITLE%' },
   { label: 'hatena',         value: '[%URL%:title=%TITLE%]' },
   { label: 'hatenacite',     value: '>%URL%:title=%TITLE%>\n%SEL%\n<<' },
   { label: 'markdown',       value: '[%SEL%](%URL% "%TITLE%")' },
   { label: 'htmlblockquote', value: '<blockquote cite="%URL%" title="%TITLE%">%HTMLSEL%</blockquote>' },
   { label: 'htmlanchor',     value: '<a href="%URL%">%TITLE%</a>' }
];
EOM

" feedSomeKeys_3.js
command! -nargs=+ lazy autocmd VimperatorEnter .* <args>
lazy fmaps -u='mail\.google\.com/mail' c / j k n p o u e x s r a # [ ] ? gi gs gt gd ga gc
lazy fmaps -u='mail\.google\.com/mail/.*/[0-9a-f]+$' c / j,n k,p n,j p,k o u e x s r a # [ ] ? gi gs gt gd ga gc

"------------------------------------------------------------------------------
" keymap
"------------------------------------------------------------------------------
" 再起動
nnoremap <C-r> :restart<CR>

" .vimperatorrcリロード
nnoremap R :source ~/.vimperatorrc<CR>

" コロンとセミコロンを入れ替え
nnoremap ; :
nnoremap : ;

" jk移動量を増やす
nnoremap j 10j
nnoremap k 10k

" タブ移動
noremap l gt
noremap h gT

" URLコピー(copy.js)
nnoremap c :copy URL<CR>

" URLとタイトルコピー(copy.js)
nnoremap C :copy titleAndURL<CR>

" 上/下のタブをすべて閉じる(browser_object.js)
nmap <C-S-h> ,dlt<CR>
nmap <C-S-l> ,drt<CR>

"------------------------------------------------------------------------------
" etc
"------------------------------------------------------------------------------
" はてなブックマークアドオン
javascript <<EOM
liberator.globalVariables.hBookmark_shortcuts = {
    hintsAdd     : 'E',
    hintsComment : 'e',
    add          : ['E'],
    comment      : ['e'],
};
EOM
javascript if (typeof hBookmark != 'undefined') liberator.loadScript('chrome://hatenabookmark/content/vimperator/plugin/hatenabookmark.js', {__proto__: this});

" Evernote Clearly
javascript <<EOM
window.onload = function() {
  require("chrome://readable-by-evernote/content/global.js");
}
EOM
nnoremap s :js __readable_by_evernote.context_menu__call();<CR>

"------------------------------------------------------------------------------
" footer
"------------------------------------------------------------------------------
js commandline.echo('.vimperatorrc sourced.', commandline.HL_INFOMSG, commandline.FORCE_SINGLELINE);
" vim: set ft=vimperator:
